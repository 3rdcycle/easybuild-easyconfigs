# remove hardcoded paths from scripts && set MKL to false (using FOSS toolchain)
# author: Denis Kristak
diff --recursive --no-dereference -ub r-inla-Version_21.03.31_orig/rinla/inst/bin/linux/64bit/inla.run r-inla-Version_21.03.31/rinla/inst/bin/linux/64bit/inla.run
--- r-inla-Version_21.03.31_orig/rinla/inst/bin/linux/64bit/inla.run	2021-03-31 14:42:11.000000000 +0200
+++ r-inla-Version_21.03.31/rinla/inst/bin/linux/64bit/inla.run	2021-04-22 16:34:16.387695207 +0200
@@ -13,15 +13,15 @@
     fi
 fi
 
-for d in {,/usr}/lib64 /usr/lib64/R/lib {,/usr}/lib/x86_64-linux-gnu {,/usr}/lib; do
-    if [ -d "$d" ]; then
-	if [ -z "$D" ]; then
-	    D="$d"
-	else
-	    D="$D:$d"
-	fi
-    fi
-done
+# for d in {,/usr}/lib64 /usr/lib64/R/lib {,/usr}/lib/x86_64-linux-gnu {,/usr}/lib; do
+#     if [ -d "$d" ]; then
+# 	if [ -z "$D" ]; then
+# 	    D="$d"
+# 	else
+# 	    D="$D:$d"
+# 	fi
+#     fi
+# done
 
 for f in $DIR/first/lib*.so*; do
     case "$f" in

diff --recursive --no-dereference -ub r-inla-Version_21.03.31_orig/rinla/R/options.R r-inla-Version_21.03.31/rinla/R/options.R
--- r-inla-Version_21.03.31_orig/rinla/R/options.R	2021-03-31 14:42:11.000000000 +0200
+++ r-inla-Version_21.03.31/rinla/R/options.R	2021-04-22 17:02:28.348043118 +0200
@@ -97,7 +97,7 @@
             num.threads = paste0(parallel::detectCores(all.tests = TRUE, logical = FALSE), ":1"),
             blas.num.threads = 0L,
             smtp = "default",
-            mkl = if (inla.os("linux") || inla.os("mac")) TRUE else FALSE,
+            mkl = FALSE,
             pardiso.license = NULL,
             keep = FALSE,
             working.directory = NULL,
