easyblock = 'CmdCp'

name = 'Short-Pair'
version = '20170125'

homepage = 'https://sourceforge.net/projects/short-pair'
description = "Sensitive Short Read Homology Search for Paired-End Reads"

toolchain = {'name': 'foss', 'version': '2021b'}

source_urls = [SOURCEFORGE_SOURCE]
sources = [{'download_filename': 'Short-Pair.tar.gz', 'filename': SOURCE_TAR_GZ}]
checksums = ['c8c759cf4cc871180107dd86e397d34787acad33d024debd70710edb437769b3']

patches = ['Short-Pair-20170125-Python3fix.patch']

dependencies = [
    ('Python', '3.9.6'),
    ('HMMER', '3.3.2'),
    ('SciPy-bundle', '2021.10')
]

exts_list = [
    ('numpy', '1.22.0', {
        'source_urls': ['https://files.pythonhosted.org/packages/50/e1/9b0c184f04b8cf5f3c941ffa56fbcbe936888bdac9aa7ba6bae405ac752b/'],
        'sources': ['%(name)s-%(version)s.zip'],
    })
]

cmds_map = [('.*', "$CXX $CXXFLAGS -w -o DNA2Protein DNA2Protein.cpp")]

files_to_copy = [(['DNA2Protein', 'get_hmm.sh', 'hmmer3_pipeline_missing_end.sh', 'Short-Pair.py'], 'bin')]

fix_python_shebang_for = ['bin/Short-Pair.py']

postinstallcmds = ["chmod a+rx %(installdir)s/bin/*"]

exts_defaultclass = 'PythonBundle'

sanity_check_paths = {
    'files': ['bin/DNA2Protein', 'bin/get_hmm.sh', 'bin/hmmer3_pipeline_missing_end.sh', 'bin/Short-Pair.py'],
    'dirs': [],
}

sanity_check_commands = ["python3 bin/Short-Pair.py -h"]

moduleclass = 'bio'
